<!-- #measurements.hbs -->
<table class="table table-striped table-sm">
    {{> caption}}
    <thead>
        <tr>
            <th scope="rowgroup"
                style="width: 6ch;">
                <button title="New Measurement"
                        id="newMeasurement"
                        class="btn btn-outline-light btn-sm"
                        onclick="showMeasurementCreate()">
                    Ôºã
                </button>
            </th>
            <th scope="col"
                style="width: 13ch">Entry Date</th>
            <th scope="col"
                class="text-center"
                style="width:9ch">Deviation</th>
            <th scope="col"
                class="text-center"
                style="width:6ch">Type</th>
            <th scope="col"
                class="text-center"
                style="width: 20ch">Drift</th>
            <th scope="col">Comment</th>
        </tr>
    </thead>
    <tbody>
        <tr style="display:none"
            id="measureCreate">
            <th scope="row">
                <span>
                    <button title="Cancel"
                            onclick="hideMeasurementCreate()">‚ùå</button>
                    <button title="Save Record"
                            onclick="htmx.trigger('#unsavedMeasurement-form', 'trigger')">üíæ</button>
                </span>
            </th>
            <form id="unsavedMeasurement-form"
                  hx-post="{{appPath}}/auth/measure/{{watch.id}}"
                  hx-target="closest table"
                  hx-swap="outerHTML"
                  hx-trigger="trigger">
                <td>
                    <input id="measureCreateDateTime"
                           type="datetime-local"
                           name="createdAt">
                </td>
                <td>
                    <input type="number"
                           name="value"
                           value="0">
                </td>
                <td><input type="checkbox"
                           name="isStart"
                           value="true"></td>
                <td class="sekPerDay">
                </td>
                <td>
                    <input type="text"
                           name="comment"
                           placeholder="enter comment">
                </td>
            </form>
        </tr>
        {{#each watch.measurements}}
        <tr style="display:none"
            id="{{id}}-edit"
            data-id="{{id}}">
            <th scope="row">
                <span>
                    <button title="delete Record"
                            hx-delete="{{../appPath}}/auth/measure/{{id}}"
                            hx-target="closest table"
                            hx-swap="outerHTML">üöÆ</button>
                    <button title="cancel Edit"
                            onclick="editMode('{{id}}', false)">‚ùå</button>
                    <button title="Save Record"
                            onclick="htmx.trigger('#{{id}}-form', 'trigger')">üíæ</button>
                </span>
            </th>
            <form id="{{id}}-form"
                  hx-patch="{{../appPath}}/auth/measure/{{id}}"
                  hx-target="closest table"
                  hx-swap="outerHTML"
                  hx-trigger="trigger">
                <td>
                    <input type="datetime-local"
                           name="createdAt"
                           value="{{createdAt16}}">
                </td>
                <td>
                    <input type="number"
                           name="value"
                           value="{{value}}">
                </td>
                <td><input type="checkbox"
                           name="isStart"
                           value="true"
                           {{#if
                           isStart}}checked{{/if}}></td>
                <td class="sekPerDay ps-2">
                    {{driftDisplay}}
                </td>
                <td>
                    <input type="text"
                           name="comment"
                           {{#if
                           comment}}
                           value="{{comment}}"
                           {{else}}
                           placeholder="enter comment"
                           {{/if}}>
                </td>
            </form>
        </tr>
        <tr id="{{id}}-show"
            data-id="{{id}}">
            <th scope="row">
                <button title="Edit Measurement"
                        class="btn btn-outline-light btn-sm startStop"
                        onclick="editMode('{{id}}', true)">‚úèÔ∏è</button>
            </th>
            <td>
                {{formatDate createdAt16}} <!-- TODO helper.replace("T", " ") -->
            </td>
            <td class="text-center">
                {{value}}s
            </td>
            <td class="text-center">
                {{#if isStart}}
                üé¨
                {{else}}
                ‚åõ
                {{/if}}
            </td>
            <td class="sekPerDay ps-2">
                {{driftDisplay}}
            </td>
            <td>
                {{comment}}
            </td>
        </tr>
        {{/each}}
    </tbody>
    <tfoot>
        <tr>
            {{#if watch.overallMeasure}}
            <td class="driftSummary text-center text-secondary-emphasis"
                colspan="6">
                (Duration: {{watch.overallMeasure.durationDays}} Days, Drift: {{watch.overallMeasure.driftSeks}} Sec =>
                {{watch.overallMeasure.niceDisplay}})
            </td>
            {{else}}
            <td class="driftSummary text-center text-secondary-emphasis"
                colspan="6">No records yet</td>
            {{/if}}
        </tr>
    </tfoot>
</table>
<!-- /measurements.hbs -->